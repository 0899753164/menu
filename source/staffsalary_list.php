<?php//session_start();require_once("../Project/database/Db.php");$objDb = new Db();$db = $objDb->database;////////////////////////////////////////Search///////////////////////////////////////////////$search= '';      //Search//if (isset($_POST['varsearch'])) {  $varsearch = $_POST['varsearch'];  $search = " WHERE `staff_name` LIKE '%$varsearch%' OR `salary_status` LIKE '%$varsearch%' ";}//////////////////////////////////////////////////////////////////////////////////////////////*//////////////////////////////////sum groub by////////////////////////////////////////////SELECT`salary_id`,staff.staff_name,SUM(`salary_receiveAm`) AS salary_amount,`salary_paydate`,`salary_status` FROM payrollstaff INNER JOIN staff ON payrollstaff.`staffsalary_fid` = staff.staff_id GROUP BY staff.staff_name///////////////////////////////////END/////////////////////////////////////////////////*/$sql = "SELECT payrollstaff.*, staff.staff_name, staff.staff_id FROM payrollstaff INNER JOIN staff ON payrollstaff.staffsalary_fid = staff.staff_id $search ORDER BY payrollstaff.salary_status ASC";//$sql = "SELECT * FROM payrollstaff";$stmt = $db->prepare($sql);//prepare data after select//$stmt->execute(); 		/*    ///convert column names from tables in database. is a php variable$stmt->bindParam(":salary_id", $salary_id, PDO::PARAM_INT);$stmt->bindParam(":salary_paydate", $salary_paydate, PDO::PARAM_STR);$stmt->bindParam(":salary_payroll", $salary_payroll, PDO::PARAM_INT);$stmt->bindParam(":salary_status", $salary_status, PDO::PARAM_STR);$stmt->bindParam(":salary_ovtWdr", $salary_ovtWdr, PDO::PARAM_INT);$stmt->bindParam(":salary_receiveAm", $salary_receiveAm, PDO::PARAM_INT);$stmt->bindParam(":salary_total", $salary_total, PDO::PARAM_INT);$result = $stmt->execute(array(':salary_id'=>$salary_id, 	':salary_paydate'=>$salary_paydate, ':salary_payroll'=>$salary_payroll, 	':salary_status'=>$salary_status, ':salary_ovtWdr'=>$salary_ovtWdr, ':salary_receiveAm'=>$salary_receiveAm,  ':salary_total'=>$salary_total)); //5*/?><!DOCTYPE html><html><head>    <title>show Product</title></head>  <body>  	<div class="main">  		<b><h3>ข้อมูลการเบิกจ่ายเงินเดือนพนักงาน</h3></b>  		<br>  		<br><div class="row">	<div class="col-8">    <form class="form-inline" action="index.php?page=salary" method="post" >        <input class="form-control" type="text" name="varsearch" value="<?php         if(isset($_POST['varsearch'])){echo $_POST['varsearch'];}        ?>" placeholder="ค้นหาด้วยชื่อ/สถานะรับเงิน" aria-label="Search">&nbsp;        <button class="btn btn-outline-dark my-2 my-sm-0" type="submit">ค้นหา</button>      </form>  </div>	<div class="col-sm-4" align="right">		<div class="btn-group">       <a href="index.php?page=staffsalary_report"><button class="btn btn-success" type="submit" name="button" value="" class="btn btn-primary btn-md"><i class="fa fa-print" aria-hidden="true"></i>&nbsp;พิมพ์</button></a>&nbsp;			<a href="index.php?page=addnewstaffsalry"><button class="btn btn-success" type="submit" name="button" value="" class="btn btn-primary btn-md"><i class="fa fa-plus-square" aria-hidden="true"></i></i>&nbsp;เพิ่มข้อมูล</button></a>	  	</div>	</div></div>  <p></p>  	<p></p>    <div class="table-responsive">    <table class="table table-hover table-white table-rounded">      <thead>        <tr id="tbhead">          <!--<th>รหัสการเบิกจ่ายเงินเดือน</th>-->          <th>ชื่อพนักงาน</th>          <th>วันที่จ่ายเงินเดือน</th>          <th>ค่าจ้าง/เดือน</th>          <th>เบิกล่วงหน้า</th>          <th>จำนวนเงินที่รับ</th>          <th>ยอดรวม</th>          <th>สถานะรับเงิน</th>          <th>จัดการข้อมูล          <button type="button" class="btn btn-danger btn-sm" id="delete"><i class="fa fa-trash" aria-hidden="true"></i>ลบที่เลือก</button>&nbsp;&nbsp;&nbsp;<input type="checkbox" id="checkAll"></th>        </tr>      </thead>      <tbody>        <?php while($row = $stmt->fetch(PDO::FETCH_OBJ)){ ?>        <tr>          <td><?php echo $row->staff_name ?></td>          <td><?php echo $row->salary_paydate ?></td>          <td><?php echo $row->salary_payroll ?></td>          <td><?php echo $row->salary_ovtWdr ?></td>          <td><?php echo $row->salary_receiveAm ?></td>          <td><?php echo $row->salary_total ?></td>           <td><?php echo $row->salary_status ?></td>          <td>          <a href="index.php?page=salaryEditform&salary_id=<?= $row->salary_id; ?>" style="text-decoration:none; color: #ffffff;"><button class="btn btn-info"><i class="fa fa-wrench" aria-hidden="true"></i>แก้ไข</a></button> |              <a href="./source/edit.php?page=salaryEditform&salary_id=<?= $row->salary_id; ?>" style="text-decoration:none" id="del" onclick="if(!confirm('กรุณายืนยันการลบข้อมูล')) { return false; }"><button class="btn btn-danger"><i class="fa fa-trash" aria-hidden="true"></i>ลบ</button></a>              <input class="checkbox" type="checkbox" id="<?php echo $row->salary_id; ?>" name="id[]"></td>        </tr>        <?php } ?>      </tbody>    </table></div></div><!--------Delete multiple records using checkbox in PHP and MySQL without refreshing page------><script>  $(document).ready(function(){      $('#checkAll').click(function(){         if(this.checked){             $('.checkbox').each(function(){                this.checked = true;             });            }else{            $('.checkbox').each(function(){                this.checked = false;             });         }       });    $('#delete').click(function(){       var dataArr  = new Array();       if($('input:checkbox:checked').length > 0){          $('input:checkbox:checked').each(function(){              dataArr.push($(this).attr('id'));              $(this).closest('tr').remove();          });          sendResponse(dataArr)       }else{         alert('กรุณาเลือกถูกในช่อง [/] ก่อน! ');       }    });    function sendResponse(dataArr){        $.ajax({            type    : 'post',            url     : './source/edit.php',            data    : {'datasalary' : dataArr},            success : function(response){                        alert(response);                      },            error   : function(errResponse){                      alert(errResponse);                      }        });    }  });</script><!--------Delete multiple records using checkbox in PHP and MySQL without refreshing page------>  </body></html>